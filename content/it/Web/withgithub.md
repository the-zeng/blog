---
title: Use Hugo with github
---

markdownファイルにtitle以外の情報を書き込むのは面倒くさいですし，移植性が低くなりなんか嫌です．

githubを使って管理したいのは

- author情報
- 記事の人気度
- 記事へのコメント

あたりです．

これを実現するには **1つの記事を1つのmerge commitに対応させる**という戦略をとればいいと思われます．
このmerge commitに著者情報が含まれ，そこへのコメントをそのまま記事へのコメントとして扱い，最初のコメント（自動生成させる）への「いいね！」などを記事のポイントとして反映させるという手段がとれます．

あとは，このmerge commitの情報をどのように取り出すかです．
ここで管理者がmergeをするタイミングでスクリプトが走ればよいのですが，このスクリプトの中身を考えます．

一番最初に思いつく課題はcommitのID(生成されたhash)をどのように取得するかです．
逆にIDさえわかればなんでもできる気がします．

イメージとしては
git mergeをうつのと同時にmaster branchのdata/IDlist.datみたいなファイルにIDを追加していくのがいいですかね．
git mergeを含めたスクリプトを書いておくといいかな．

ただこれでは記事ファイルとcommitIDがまだ対応していません．
commit IDに含まれる情報からうまいことできないか考えます．

すべてに記事に共通で含まれる情報はfile名ぐらいなのでcommitIDから追加したfile名を取り出すことができればいけそうです．

[github公式](https://developer.github.com/v3/repos/commits/)
をみますと，「編集したfileのリスト」がcommitに紐づけられているようです．

各記事を表示するhtml群のどこかに
1. 記事のファイル名を取得．
2. ファイル名に紐づいたcommit IDをIDlistから取得．
3. APIを使ってcommit IDからそこについたファーストコメント（自動生成）への評価，それ以降のコメントを表示．
4. ページからgithubに評価，コメントができるようにもしたい．

## 同一ファイル名への対策
これは対処法が二つあり，
- 同一ファイル名がつくられにくい命名規則を策定
- ファイルへ名前以外の性質の付与
があります．

一番簡単なのは命名規則の策定で，
タイトル_筆者.md
に設定するようにすれば，
- 自分で同じ名前のファイルを2つつくっちゃう．
- 誰かの名前を騙る
ことがない限り大丈夫です．


Q. githubへのAPIは静的サイトから自動的に走ってくれる？


